<div class="row vertical-center d-block">
    <div class="horizontal-center">
        <div class="card">
            <div class="card-block">
                <div class="card-header bg-white mb-3">
                    <h4 class="card-title">Forgot password</h4>
                    <p class="mb-0">Enter your account email to receive a reset token. In development, the token is returned below.</p>
                </div>

                <form (ngSubmit)="submit(forgotForm)" [formGroup]="forgotForm">
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input id="email" type="email" class="form-control" [ngClass]="{ 'is-invalid': f.email.touched && f.email.errors }" name="email" placeholder="Email" formControlName="email" required>
                        @if (f.email.touched && f.email.errors) {
                        <div class="invalid-feedback">
                            @if (f.email.errors.required) {
                            <div>Email is required</div>
                            }
                            @if (f.email.errors.email) {
                            <div>Enter a valid email</div>
                            }
                        </div>
                        }
                    </div>

                    <div class="form-group d-flex align-items-center justify-content-between mt-3">
                        <div>
                            <button type="submit" class="btn btn-primary" [disabled]="forgotForm.invalid || isRequesting">Send reset token</button>
                            <!-- <app-spinner [isRunning]="isRequesting"></app-spinner> -->
                        </div>
                        <a class="text-decoration-none" routerLink="/login">Back to login</a>
                    </div>
                </form>

                @if (message) {
                <div class="alert alert-success mt-3" role="alert">
                    <strong>Done:</strong> {{message}}
                    @if (token) {
                    <div class="mt-2">
                        <div class="small text-muted">Development token (copy into the reset form):</div>
                        <textarea class="form-control mt-1" rows="2" readonly>{{token}}</textarea>
                        <a class="small" [routerLink]="['/reset-password']" [queryParams]="{ email: forgotForm.value.email, token: token }">Go to reset form</a>
                    </div>
                    }
                </div>
                }

                @if (errors) {
                <div class="alert alert-danger mt-3" role="alert">
                    <strong>Oops!</strong> {{errors}}
                </div>
                }
            </div>
        </div>
    </div>
</div>